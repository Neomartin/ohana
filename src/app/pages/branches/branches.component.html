<div class="row noDisplay">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <div class="row row-branch">
          <div class="branch-title-container" fxLayout="row">
            <div class="branch-title">
              <h1 class="text-green">SUCURSALES</h1>
              <h6 class="card-subtitle text-disabled">
                Editar información o agregar las mismas.
              </h6>
              <div (click)="addBranchDialog(null, 'Agregar')" class="" style="">
                <div class="text-white mb-0 butoncin">
                  <i class="mdi mdi-plus-circle-outline text-success f-24 mr-1"></i>
                  <span class="f-20">
                    Agregar
                  </span>
                </div>
                <div fxFlex></div>
              </div>
            </div>
            <div class="branchis ml-auto">
              <img src="./assets/images/branch.jpg" alt="">
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-12">
            <table mat-table [dataSource]="dataSource" matSort style="width: 100%;">
              <ng-container matColumnDef="name">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex>
                  Sucursal
                </th>
                <td mat-cell *matCellDef="let branch; let i = index" fxLayoutAlign="start center" fxFlex>
                  <div *ngIf="branch._id !== editable">
                    {{ branch.name  }}
                  </div>
                  <div *ngIf="branch._id === editable">
                    <mat-form-field fxFlex style="margin-right: 7px;" class="inputNew">
                      <input type="text" matInput placeholder="branch" [(ngModel)]="branch.name" name="name" />
                    </mat-form-field>
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="adress">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex>
                  Dirección
                </th>
                <td mat-cell *matCellDef="let branch; let i = index" fxLayoutAlign="start center" fxFlex>
                  <div *ngIf="branch._id !== editable">
                    <ng-container *ngIf="branch.adress; else elseAdress">
                      {{ branch.adress}}
                      <span>
                        {{ branch.adress_number}}
                      </span>
                    </ng-container>
                    <ng-template #elseAdress>
                      Sin Dirección
                    </ng-template>
                  </div>
                  <div *ngIf="branch._id === editable">
                    <mat-form-field fxFlex="65" class="m-r-20">
                      <input type="text" matInput [(ngModel)]="branch.adress" name="adress" />
                    </mat-form-field>
                    <mat-form-field fxFlex="35" class="m-r-20">
                      <input type="text" matInput [(ngModel)]="branch.adress_number" name="adress_number" />
                    </mat-form-field>
                  </div>
                </td>
              </ng-container>
              <ng-container matColumnDef="location">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex="190px">
                  Localidad
                </th>
                <td mat-cell *matCellDef="let branch; let i = dataIndex" fxLayoutAlign="start center" fxFlex="190px">
                  <div *ngIf="branch._id !== editable">
                    <ng-container *ngIf="branch.location; else elseLocation">
                      {{ branch.location}}
                    </ng-container>
                    <ng-template #elseLocation>
                      Agregar localidad
                    </ng-template>
                  </div>
                  <div *ngIf="branch._id === editable">
                    <mat-form-field class="m-r-20">
                      <input type="text" matInput [(ngModel)]="branch.location" name="location" />
                    </mat-form-field>
                  </div>
                </td>
              </ng-container>

              <ng-container matColumnDef="phone">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex="115px">
                  Teléfono
                </th>
                <td mat-cell *matCellDef="let branch; let i = index" fxLayoutAlign="start center" fxFlex="115px">
                  <!-- <span *ngFor="let branch of branches; let k = index; "> -->
                  <div *ngIf="branch._id !== editable">
                    <ng-container *ngIf="phone === '260-4' || !branch.phone; else elsePhone">
                      Sin Teléfono
                    </ng-container>
                    <ng-template #elsePhone>
                      {{ branch.phone }}
                    </ng-template>
                  </div>
                  <div *ngIf="branch._id === editable">
                    <mat-form-field class="p-r-10">
                      <textarea type="text" matInput [(ngModel)]="branch.phone" name="phone"  rows="2"></textarea>
                      <!-- <ng-template #elsePhone>
                          <input type="text" matInput name="phone" [(ngModel)]="branch.phone">
                        </ng-template> -->
                    </mat-form-field>
                  </div>
                  <!-- </span> -->
                </td>
              </ng-container>

              <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex="220px" class="p-l-10">
                  Email
                </th>
                <td mat-cell *matCellDef="let branch; let i = index" fxLayoutAlign="start center" fxFlex="220px">
                  <!-- <span *ngFor="let branch of branches; let k = index; "> -->
                  <div *ngIf="branch._id !== editable" class="p-l-10">
                    <ng-container *ngIf="!branch.email; else elseemail">
                      <span class="text-warning">
                        Sin email
                      </span>
                    </ng-container>
                    <ng-template #elseemail>
                      {{ branch.email }}
                    </ng-template>
                  </div>
                  <div *ngIf="branch._id === editable">
                    <mat-form-field class="p-r-10">
                      <input type="text" matInput [(ngModel)]="branch.email" name="email">
                      <!-- <ng-template #elsePhone>
                          <input type="text" matInput name="phone" [(ngModel)]="branch.phone">
                        </ng-template> -->
                    </mat-form-field>
                  </div>
                  <!-- </span> -->
                </td>
              </ng-container>
              <!-- <ng-container matColumnDef="office" *ngIf="currentUser.role === 'ADMIN_ROLE'" fxFlex="160px">
                  San Rafael - Olascoaga 21
                </ng-container> -->
              <ng-container matColumnDef="options">
                <th mat-header-cell *matHeaderCellDef fxLayoutAlign="start center" fxFlex="76px">
                  Editar
                </th>
                <td mat-cell *matCellDef="let branch, let i = index" fxLayoutAlign="start center" fxFlex="76px">
                  <div *ngIf="branch._id !== editable">
                    <!-- BRANCH VIEW

                     <button class="btn btn-sm btn-warning m-r-2" matTooltip="Ir al perfil del cliente"
                      (click)="viewClient(branch._id); $event.stopPropagation()">
                      <i class="mdi mdi-eye"></i>
                    </button> -->

                    <!-- BRANCH EDIT -->

                    <button matTooltip="Editar Sucursal" (click)="setEditable(branch._id, i); $event.stopPropagation()"
                      class="btn waves-effect waves-light btn-sm btn-success m-r-5" type="button">
                      <i class="mdi mdi-border-color"></i>
                    </button>

                    <!-- BRANCH DELETE -->
                    <button *ngIf="user.user.role === 'ADMIN_ROLE'"
                      (click)="deleteBranch(branch, i); $event.stopPropagation()" class="btn btn-sm btn-danger"
                      matTooltip="Eliminar Sucursal">
                      <i class="mdi mdi-delete"></i>
                    </button>

                  </div>
                  <div *ngIf="branch._id === editable">
                    <button matTooltip="Confirmar datos" (click)="updateBranch(branch); $event.stopPropagation()"
                      class="btn waves-effect waves-light btn-sm b-green" type="button" style="margin-right: 2px">
                      <i class="mdi mdi-check"></i>
                    </button>
                    <button class="btn btn-sm b-red" matTooltip="Cancelar"
                      (click)="setEditable(null, i); $event.stopPropagation()">
                      <i class="mdi mdi-close"></i>
                    </button>
                  </div>

                </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <mat-paginator [pageSizeOptions]="[10, 20, 40, 100]"></mat-paginator>
          </div>



        </div>
      </div>
    </div>
  </div>
</div>
